
% This function takes in Temperature and Pressure, and outputs the remaining thermo variables
%   Index --- Variable
%   1         Pressure (bar)
%   2         Temperature (degC)
%   3         nu
%   4         u
%   5         h
%   6         s
%
%  Example.  Find h for P=60bar and T=280C.
%  h_output = Table_A4_Dynamic(60,1,280,2,5);
function Table_A12_R134a_SUPHEATED_Dynamic_SI(Input1,Input1_type,Input2,Input2_type,Output1_type)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This function takes in Temperature and Pressure, and outputsthe remaining thermo variables
% Note to reader: See how this version is not that conducive for "learning".  The other variant is
% easier to follow.
%
%   Index --- Variable
%   1         Pressure (bar)
%   2         Temperature (degC)
%   3         nu
%   4         u
%   5         h
%   6         s
%
%  Example.  Find h for P=60bar and T=280C.
%  h_output = Table_A4_Dynamic(60,1,280,2,5);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Test relics.  Delete when this becomes a proper function
% Input1 = 200;
% Input1_type = 2; %200degC
% Input2 = 2;
% Input2_type = 1; %2 bar (omg I hate this unit)
% Output1_type = 4;%give me output of u

%table = [  P       T   nu      u       h      s     ];
%units      bar     degC m^3/kg kJ/kg   kJ/kg  kJ/kg/K
%% Raw DATA entry
table_A4=[  0.6	37.07	0.31003	206.12	224.72	0.952
			0.6	-20	0.33536	217.86	237.98	1.0062
			0.6	-10	0.34992	224.97	245.96	1.0371
			0.6	0	0.36433	232.24	254.1	1.0675
			0.6	10	0.37861	239.69	262.41	1.0973
			0.6	20	0.39279	247.32	270.89	1.1267
			0.6	30	0.40688	255.12	279.53	1.1557
			0.6	40	0.42091	263.1	288.35	1.1844
			0.6	50	0.43487	271.25	297.34	1.2126
			0.6	60	0.44879	279.58	306.51	1.2405
			0.6	70	0.46266	288.08	315.84	1.2681
			0.6	80	0.4765	296.75	325.34	1.2954
			0.6	90	0.49031	305.58	335	1.3224
			1	26.43	0.1917	212.18	231.35	0.9395
			1	-20	0.1977	216.77	236.54	0.9602
			1	-10	0.20686	224.01	244.7	0.9918
			1	0	0.21587	231.41	252.99	1.0227
			1	10	0.22473	238.96	261.43	1.0531
			1	20	0.23349	246.67	270.02	1.0829
			1	30	0.24216	254.54	278.76	1.1122
			1	40	0.25076	262.58	287.66	1.1411
			1	50	0.2593	270.79	296.72	1.1696
			1	60	0.26779	279.16	305.94	1.1977
			1	70	0.27623	287.7	315.32	1.2254
			1	80	0.28464	296.4	324.87	1.2528
			1	90	0.29302	305.27	334.57	1.2799
			1.4	-18.8	0.13945	216.52	236.04	0.9322
			1.4	-10	0.14549	223.03	243.4	0.9606
			1.4	0	0.15219	230.55	251.86	0.9922
			1.4	10	0.15875	238.21	260.43	1.023
			1.4	20	0.1652	246.01	269.13	1.0532
			1.4	30	0.17155	253.96	277.97	1.0828
			1.4	40	0.17783	262.06	286.96	1.112
			1.4	50	0.18404	270.32	296.09	1.1407
			1.4	60	0.1902	278.74	305.37	1.169
			1.4	70	0.19633	287.32	314.8	1.1969
			1.4	80	0.20241	296.06	324.39	1.2244
			1.4	90	0.20846	304.95	334.14	1.2516
			1.4	100	0.21449	314.01	344.04	1.2785
			1.8	-12.73	0.10983	219.94	239.71	0.9273
			1.8	-10	0.11135	222.02	242.06	0.9362
			1.8	0	0.11678	229.67	250.69	0.9684
			1.8	10	0.12207	237.44	259.41	0.9998
			1.8	20	0.12723	245.33	268.23	1.0304
			1.8	30	0.1323	253.36	277.17	1.0604
			1.8	40	0.1373	261.53	286.24	1.0898
			1.8	50	0.14222	269.85	295.45	1.1187
			1.8	60	0.1471	278.31	304.79	1.1472
			1.8	70	0.15193	286.93	314.28	1.1753
			1.8	80	0.15672	295.71	323.92	1.203
			1.8	90	0.16148	304.63	333.7	1.2303
			1.8	100	0.16622	313.72	343.63	1.2573
			2	-10.09	0.09933	221.43	241.3	0.9253
			2	-10	0.09938	221.5	241.38	0.9256
			2	0	0.10438	229.23	250.1	0.9582
			2	10	0.10922	237.05	258.89	0.9898
			2	20	0.11394	244.99	267.78	1.0206
			2	30	0.11856	253.06	276.77	1.0508
			2	40	0.12311	261.26	285.88	1.0804
			2	50	0.12758	269.61	295.12	1.1094
			2	60	0.13201	278.1	304.5	1.138
			2	70	0.13639	286.74	314.02	1.1661
			2	80	0.14073	295.53	323.68	1.1939
			2	90	0.14504	304.47	333.48	1.2212
			2	100	0.14932	313.57	343.43	1.2483
			2.4	-5.37	0.08343	224.07	244.09	0.9222
			2.4	0	0.08574	228.31	248.89	0.9399
			2.4	10	0.08993	236.26	257.84	0.9721
			2.4	20	0.09399	244.3	266.85	1.0034
			2.4	30	0.09794	252.45	275.95	1.0339
			2.4	40	0.10181	260.72	285.16	1.0637
			2.4	50	0.10562	269.12	294.47	1.093
			2.4	60	0.10937	277.67	303.91	1.1218
			2.4	70	0.11307	286.35	313.49	1.1501
			2.4	80	0.11674	295.18	323.19	1.178
			2.4	90	0.12037	304.15	333.04	1.2055
			2.4	100	0.12398	313.27	343.03	1.2326
			2.8	-1.23	0.07193	226.38	246.52	0.9197
			2.8	0	0.0724	227.37	247.64	0.9238
			2.8	10	0.07613	235.44	256.76	0.9566
			2.8	20	0.07972	243.59	265.91	0.9883
			2.8	30	0.0832	251.83	275.12	1.0192
			2.8	40	0.0866	260.17	284.42	1.0494
			2.8	50	0.08992	268.64	293.81	1.0789
			2.8	60	0.09319	277.23	303.32	1.1079
			2.8	70	0.09641	285.96	312.95	1.1364
			2.8	80	0.0996	294.82	322.71	1.1644
			2.8	90	0.10275	303.83	332.6	1.192
			2.8	100	0.10587	312.98	342.62	1.2193
			2.8	110	0.10897	322.27	352.78	1.2461
			2.8	120	0.11205	331.71	363.08	1.2727
			3.2	2.48	0.06322	228.43	248.66	0.9177
			3.2	10	0.06576	234.61	255.65	0.9427
			3.2	20	0.06901	242.87	264.95	0.9749
			3.2	30	0.07214	251.19	274.28	1.0062
			3.2	40	0.07518	259.61	283.67	1.0367
			3.2	50	0.07815	268.14	293.15	1.0665
			3.2	60	0.08106	276.79	302.72	1.0957
			3.2	70	0.08392	285.56	312.41	1.1243
			3.2	80	0.08674	294.46	322.22	1.1525
			3.2	90	0.08953	303.5	332.15	1.1802
			3.2	100	0.09229	312.68	342.21	1.2076
			3.2	110	0.09503	322	352.4	1.2345
			3.2	120	0.09774	331.45	362.73	1.2611
			4	8.93	0.05089	231.97	252.32	0.9145
			4	10	0.05119	232.87	253.35	0.9182
			4	20	0.05397	241.37	262.96	0.9515
			4	30	0.05662	249.89	272.54	0.9837
			4	40	0.05917	258.47	282.14	1.0148
			4	50	0.06164	267.13	291.79	1.0452
			4	60	0.06405	275.89	301.51	1.0748
			4	70	0.06641	284.75	311.32	1.1038
			4	80	0.06873	293.73	321.23	1.1322
			4	90	0.07102	302.84	331.25	1.1602
			4	100	0.07327	312.07	341.38	1.1878
			4	110	0.0755	321.44	351.64	1.2149
			4	120	0.07771	330.94	362.03	1.2417
			4	130	0.07991	340.58	372.54	1.2681
			4	140	0.08208	350.35	383.18	1.2941
			5	15.74	0.04086	235.64	256.07	0.9117
			5	20	0.04188	239.4	260.34	0.9264
			5	30	0.04416	248.2	270.28	0.9597
			5	40	0.04633	256.99	280.16	0.9918
			5	50	0.04842	265.83	290.04	1.0229
			5	60	0.05043	274.73	299.95	1.0531
			5	70	0.0524	283.72	309.92	1.0825
			5	80	0.05432	292.8	319.96	1.1114
			5	90	0.0562	302	330.1	1.1397
			5	100	0.05805	311.31	340.33	1.1675
			5	110	0.05988	320.74	350.68	1.1949
			5	120	0.06168	330.3	361.14	1.2218
			5	130	0.06347	339.98	371.72	1.2484
			5	140	0.06524	349.79	382.42	1.2746
			6	21.58	0.03408	238.74	259.19	0.9097
			6	30	0.03581	246.41	267.89	0.9388
			6	40	0.03774	255.45	278.09	0.9719
			6	50	0.03958	264.48	288.23	1.0037
			6	60	0.04134	273.54	298.35	1.0346
			6	70	0.04304	282.66	308.48	1.0645
			6	80	0.04469	291.86	318.67	1.0938
			6	90	0.04631	301.14	328.93	1.1225
			6	100	0.0479	310.53	339.27	1.1505
			6	110	0.04946	320.03	349.7	1.1781
			6	120	0.05099	329.64	360.24	1.2053
			6	130	0.05251	339.38	370.88	1.232
			6	140	0.05402	349.23	381.64	1.2584
			6	150	0.0555	359.21	392.52	1.2844
			6	160	0.05698	369.32	403.51	1.31
			7	26.72	0.02918	241.42	261.85	0.908
			7	30	0.02979	244.51	265.37	0.9197
			7	40	0.03157	253.83	275.93	0.9539
			7	50	0.03324	263.08	286.35	0.9867
			7	60	0.03482	272.31	296.69	1.0182
			7	70	0.03634	281.57	307.01	1.0487
			7	80	0.03781	290.88	317.35	1.0784
			7	90	0.03924	300.27	327.74	1.1074
			7	100	0.04064	309.74	338.19	1.1358
			7	110	0.04201	319.31	348.71	1.1637
			7	120	0.04335	328.98	359.33	1.191
			7	130	0.04468	338.76	370.04	1.2179
			7	140	0.04599	348.66	380.86	1.2444
			7	150	0.04729	358.68	391.79	1.2706
			7	160	0.04857	368.82	402.82	1.2963
			8	31.33	0.02547	243.78	264.15	0.9066
			8	40	0.02691	252.13	273.66	0.9374
			8	50	0.02846	261.62	284.39	0.9711
			8	60	0.02992	271.04	294.98	1.0034
			8	70	0.03131	280.45	305.5	1.0345
			8	80	0.03264	289.89	316	1.0647
			8	90	0.03393	299.37	326.52	1.094
			8	100	0.03519	308.93	337.08	1.1227
			8	110	0.03642	318.57	347.71	1.1508
			8	120	0.03762	328.31	358.4	1.1784
			8	130	0.03881	338.14	369.19	1.2055
			8	140	0.03997	348.09	380.07	1.2321
			8	150	0.04113	358.15	391.05	1.2584
			8	160	0.04227	368.32	402.14	1.2843
			8	170	0.0434	378.61	413.33	1.3098
			8	180	0.04452	389.02	424.63	1.3351
			9	35.53	0.02255	245.88	266.18	0.9054
			9	40	0.02325	250.32	271.25	0.9217
			9	50	0.02472	260.09	282.34	0.9566
			9	60	0.02609	269.72	293.21	0.9897
			9	70	0.02738	279.3	303.94	1.0214
			9	80	0.02861	288.87	314.62	1.0521
			9	90	0.0298	298.46	325.28	1.0819
			9	100	0.03095	308.11	335.96	1.1109
			9	110	0.03207	317.82	346.68	1.1392
			9	120	0.03316	327.62	357.47	1.167
			9	130	0.03423	337.52	368.33	1.1943
			9	140	0.03529	347.51	379.27	1.2211
			9	150	0.03633	357.61	390.31	1.2475
			9	160	0.03736	367.82	401.44	1.2735
			9	170	0.03838	378.14	412.68	1.2992
			9	180	0.03939	388.57	424.02	1.3245
			10	39.39	0.0202	247.77	267.97	0.9043
			10	40	0.02029	248.39	268.68	0.9066
			10	50	0.02171	258.48	280.19	0.9428
			10	60	0.02301	268.35	291.36	0.9768
			10	70	0.02423	278.11	302.34	1.0093
			10	80	0.02538	287.82	313.2	1.0405
			10	90	0.02649	297.53	324.01	1.0707
			10	100	0.02755	307.27	334.82	1.1
			10	110	0.02858	317.06	345.65	1.1286
			10	120	0.02959	326.93	356.52	1.1567
			10	130	0.03058	336.88	367.46	1.1841
			10	140	0.03154	346.92	378.46	1.2111
			10	150	0.0325	357.06	389.56	1.2376
			10	160	0.03344	367.31	400.74	1.2638
			10	170	0.03436	377.66	412.02	1.2895
			10	180	0.03528	388.12	423.4	1.3149
			12	46.32	0.01663	251.03	270.99	0.9023
			12	50	0.01712	254.98	275.52	0.9164
			12	60	0.01835	265.42	287.44	0.9527
			12	70	0.01947	275.59	298.96	0.9868
			12	80	0.02051	285.62	310.24	1.0192
			12	90	0.0215	295.59	321.39	1.0503
			12	100	0.02244	305.54	332.47	1.0804
			12	110	0.02335	315.5	343.52	1.1096
			12	120	0.02423	325.51	354.58	1.1381
			12	130	0.02508	335.58	365.68	1.166
			12	140	0.02592	345.73	376.83	1.1933
			12	150	0.02674	355.95	388.04	1.2201
			12	160	0.02754	366.27	399.33	1.2465
			12	170	0.02834	376.69	410.7	1.2724
			12	180	0.02912	387.21	422.16	1.298
			14	52.43	0.01405	253.74	273.4	0.9003
			14	60	0.01495	262.17	283.1	0.9297
			14	70	0.01603	272.87	295.31	0.9658
			14	80	0.01701	283.29	307.1	0.9997
			14	90	0.01792	293.55	318.63	1.0319
			14	100	0.01878	303.73	330.02	1.0628
			14	110	0.0196	313.88	341.32	1.0927
			14	120	0.02039	324.05	352.59	1.1218
			14	130	0.02115	334.25	363.86	1.1501
			14	140	0.02189	344.5	375.15	1.1777
			14	150	0.02262	354.82	386.49	1.2048
			14	160	0.02333	365.22	397.89	1.2315
			14	170	0.02403	375.71	409.36	1.2576
			14	180	0.02472	386.29	420.9	1.2834
			14	190	0.02541	396.96	432.53	1.3088
			14	200	0.02608	407.73	444.24	1.3338
			16	57.92	0.01208	256	275.33	0.8982
			16	60	0.01233	258.48	278.2	0.9069
			16	70	0.0134	269.89	291.33	0.9457
			16	80	0.01435	280.78	303.74	0.9813
			16	90	0.01521	291.39	315.72	1.0148
			16	100	0.01601	301.84	327.46	1.0467
			16	110	0.01677	312.2	339.04	1.0773
			16	120	0.0175	322.53	350.53	1.1069
			16	130	0.0182	332.87	361.99	1.1357
			16	140	0.01887	343.24	373.44	1.1638
			16	150	0.01953	353.66	384.91	1.1912
			16	160	0.02017	364.15	396.43	1.2181
			16	170	0.0208	374.71	407.99	1.2445
			16	180	0.02142	385.35	419.62	1.2704
			16	190	0.02203	396.08	431.33	1.296
			16	200	0.02263	406.9	443.11	1.3212];
                        
%% Re-express table_A4 to human-readable format

% P_raw  = table_A4(:,1);
% T_raw  = table_A4(:,2);
% nu_raw = table_A4(:,3);
% u_raw  = table_A4(:,4);
% h_raw  = table_A4(:,5);
% s_raw  = table_A4(:,6);

x_raw = table_A4(:,Input1_type);
y_raw = table_A4(:,Input2_type);
z_raw = table_A4(:,Output1_type);
name  = ["Pressure (bar)" , "Temperature (degC)", "nu (m^3/kg)", "u(kJ/kg)", "h(kJ/kg)", "s(kJ/kg/K"];
 
%% Building functions for output variables as a function of the input variables

F = scatteredInterpolant(x_raw,y_raw,z_raw);

[xmin,xmax] = bounds(x_raw);
[ymin,ymax] = bounds(y_raw);
[xGrid,yGrid]=meshgrid(linspace(xmin,xmax,40),linspace(ymin,ymax,40));
zGrid = F(xGrid,yGrid);

%% Calculate output variables from input variables
Output1 = F(Input1,Input2)

%% Test Plot to check input domain range.  Set dummy = 0 to suppress.

dummy = 1;
if dummy == 1
    figure;
    hold on
    contour(xGrid,yGrid,zGrid,'ShowText','on','LineWidth',1)
    plot(x_raw,y_raw,'x');
    plot(Input1,Input2,'^','MarkerSize',12,'LineWidth',2);
    hold off
    xlabel(name(Input1_type));ylabel(name(Input2_type));title(['Contours of ' name(Output1_type)]);grid on
    legend('','RAW Data Points','Request Data Point')
end

prompt1 = 'Are you finished with reading Tables? Y/N [Y] ';
str1 = input(prompt1,'s');
if str1 == 'Y'
    sprintf(" Thank you for using my code. Good luck in Thermo")
else if str1 =='N'
        prompt2 = "Do you need this table again? Y/N [Y]: ";
        str2 = input(prompt2,'s');
        if str2 =="Y"
            sprintf("Type into command Prompt: Table_A4_Dynamic(Input1,Input1_type,Input2,Input2_type,Output1_type)")
        else if str2 == "N"
                Table_reading
            end
        end
        
end
    end
