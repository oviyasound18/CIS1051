
% This function takes in Temperature and Pressure, and outputs the remaining thermo variables
%   Index --- Variable
%   1         Pressure (bar)
%   2         Temperature (degC)
%   3         nu
%   4         u
%   5         h
%   6         s
%
%  Example.  Find h for P=60bar and T=280C.
%  h_output = Table_A4_Dynamic(60,1,280,2,5);
function Table_A4_Dynamic(Input1,Input1_type,Input2,Input2_type,Output1_type)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This function takes in Temperature and Pressure, and outputsthe remaining thermo variables
% Note to reader: See how this version is not that conducive for "learning".  The other variant is
% easier to follow.
%
%   Index --- Variable
%   1         Pressure (bar)
%   2         Temperature (degC)
%   3         nu
%   4         u
%   5         h
%   6         s
%
%  Example.  Find h for P=60bar and T=280C.
%  h_output = Table_A4_Dynamic(60,1,280,2,5);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Test relics.  Delete when this becomes a proper function
% Input1 = 200;
% Input1_type = 2; %200degC
% Input2 = 2;
% Input2_type = 1; %2 bar (omg I hate this unit)
% Output1_type = 4;%give me output of u

%table = [  P       T   nu      u       h      s     ];
%units      bar     degC m^3/kg kJ/kg   kJ/kg  kJ/kg/K
%% Raw DATA entry
table_A4=[  0.06    80	27.132	2487.3	2650.1	8.5804;
            0.06	120	30.219	2544.7	2726	8.784;
            0.06	160	33.302	2602.7	2802.5	8.9693;
            0.06	200	36.383	2661.4	2879.7	9.1398;
            0.06	240	39.462	2721	2957.8	9.2982;
            0.06	280	42.54	2781.5	3036.8	9.4464;
            0.06	320	45.618	2843	3116.7	9.5859;
            0.06	360	48.696	2905.5	3197.7	9.718;
            0.06	400	51.774	2969	3279.6	9.8435;
            0.06	440	54.851	3033.5	3362.6	9.9633;
            0.06	500	59.467	3132.3	3489.1	10.1336;
            0.35	80	4.625	2483.7	2645.6	7.7564;
            0.35	120	5.163	2542.4	2723.1	7.9644;
            0.35	160	5.696	2601.2	2800.6	8.1519;
            0.35	200	6.228	2660.4	2878.4	8.3237;
            0.35	240	6.758	2720.3	2956.8	8.4828;
            0.35	280	7.287	2780.9	3036	8.6314;
            0.35	320	7.815	2842.5	3116.1	8.7712;
            0.35	360	8.344	2905.1	3197.1	8.9034;
            0.35	400	8.872	2968.6	3279.2	9.0291;
            0.35	440	9.4     3033.2	3362.2	9.149;
            0.35	500	10.192	3132.1	3488.8	9.319;
            0.7     100	2.434	2509.7	2680	7.5341;
            0.7     120	2.571	2539.7	2719.6	7.6375;
            0.7     160	2.841	2599.4	2798.2	7.8279;
            0.7     200	3.108	2659.1	2876.7	8.0012;
            0.7     240	3.374	2719.3	2955.5	8.1611;
            0.7     280	3.64	2780.2	3035	8.3162;
            0.7     320	3.905	2842	3115.3	8.4504;
            0.7     360	4.17	2904.6	3196.5	8.5828;
            0.7     400	4.434	2968.2	3278.6	8.7086;
            0.7     440	4.698	3032.9	3361.8	8.8286;
            0.7     500	5.095	3131.8	3488.5	8.9991;
            1       100	1.696	2506.7	2676.2	7.3614;
            1       120	1.793	2537.3	2716.6	7.4668;
            1       160	1.984	2597.8	2796.2	7.6597;
            1       200	2.172	2658.1	2875.3	7.8343;
            1       240	2.359	2718.5	2954.5	7.9949;
            1       280	2.546	2779.6	3034.2	8.1445;
            1       320	2.732	2841.5	3114.6	8.2849;
            1       360	2.917	2904.2	3195.9	8.4175;
            1       400	3.103	2967.9	3278.2	8.5435;
            1       440	3.288	3032.6	3361.4	8.6636;
            1       500	3.565	3131.6	3488.1	8.8342;
            1.5     160	1.317	2595.2	2792.8	7.4665;
            1.5     200	1.444	2656.2	2872.9	7.6433;
            1.5     240	1.57	2717.2	2952.7	7.8052;
            1.5     280	1.695	2778.6	3032.8	7.9555;
            1.5     320	1.819	2840.6	3113.5	8.0964;
            1.5     360	1.943	2903.5	3195	8.2293;
            1.5     400	2.067	2967.3	3277.4	8.3555;
            1.5     440	2.191	3032.1	3360.7	8.4757;
            1.5     500	2.376	3131.2	3487.6	8.6466;
            1.5     600	2.685	3301.7	3704.3	8.9101;
            3       160	0.651	2587.1	2782.3	7.1276;
            3       200	0.716	2650.7	2865.5	7.3115;
            3       240	0.781	2713.1	2947.3	7.4774;
            3       280	0.844	2775.4	3028.6	7.6299;
            3       320	0.907	2838.1	3110.1	7.7722;
            3       360	0.969	2901.4	3192.2	7.9061;
            3       400	1.032	2965.6	3275	8.033;
            3       440	1.094	3030.6	3358.7	8.1538;
            3       500	1.187	3130	3486	8.3251;
            3       600	1.341	3300.8	3703.2	8.5892;
            5       180	0.4045	2609.7	2812	6.9656;
            5       200	0.4249	2642.9	2855.4	7.0592;
            5       240	0.4646	2707.6	2939.9	7.2307;
            5	280	0.5034	2771.2	3022.9	7.3865;
            5	320	0.5416	2834.7	3105.6	7.5308;
            5	360	0.5796	2898.7	3188.4	7.666;
            5	400	0.6173	2963.2	3271.9	7.7938;
            5	440	0.6548	3028.6	3356	7.9152;
            5	500	0.7109	3128.4	3483.9	8.0873;
            5	600	0.8041	3299.6	3701.7	8.3522;
            5	700	0.8969	3477.5	3925.9	8.5952;
            7	180	0.2847	2599.8	2799.1	6.788;
            7	200	0.2999	2634.8	2844.8	6.8865;
            7	240	0.3292	2701.8	2932.2	7.0641;
            7	280	0.3574	2766.9	3017.1	7.2233;
            7	320	0.3852	2831.3	3100.9	7.3697;
            7	360	0.4126	2895.8	3184.7	7.5063;
            7	400	0.4397	2960.9	3268.7	7.635;
            7	440	0.4667	3026.6	3353.3	7.7571;
            7	500	0.507	3126.8	3481.7	7.9299;
            7	600	0.5738	3298.5	3700.2	8.1956;
            7	700	0.6403	3476.6	3924.8	8.4391;
            10	200	0.206	2621.9	2827.9	6.694;
            10	240	0.2275	2692.9	2920.4	6.8817;
            10	280	0.248	2760.2	3008.2	7.0465;
            10	320	0.2678	2826.1	3093.9	7.1962;
            10	360	0.2873	2891.6	3178.9	7.3349;
            10	400	0.3066	2957.3	3263.9	7.4651;
            10	440	0.3257	3023.6	3349.3	7.5883;
            10	500	0.3541	3124.4	3478.5	7.7622;
            10	540	0.3729	3192.6	3565.6	7.872;
            10	600	0.4011	3296.8	3697.9	8.029;
            10	640	0.4198	3367.4	3787.2	8.129;
            15	200	0.1325	2598.1	2796.8	6.4546;
            15	240	0.1483	2676.9	2899.3	6.6628;
            15	280	0.1627	2748.6	2992.7	6.8381;
            15	320	0.1765	2817.1	3081.9	6.9938;
            15	360	0.1899	2884.4	3169.2	7.1363;
            15	400	0.203	2951.3	3255.8	7.269;
            15	440	0.216	3018.5	3342.5	7.394;
            15	500	0.2352	3120.3	3473.1	7.5698;
            15	540	0.2478	3189.1	3560.9	7.6805;
            15	600	0.2668	3293.9	3694	7.8385;
            15	640	0.2793	3364.8	3783.8	7.9391;
            20	240	0.1085	2659.6	2876.5	6.4952;
            20	280	0.12	2736.4	2976.4	6.6828;
            20	320	0.1308	2807.9	3069.5	6.8452;
            20	360	0.1411	2877	3159.3	6.9917;
            20	400	0.1512	2945.2	3247.6	7.1271;
            20	440	0.1611	3013.4	3335.5	7.254;
            20	500	0.1757	3116.2	3467.6	7.4317;
            20	540	0.1853	3185.6	3556.1	7.5434;
            20	600	0.1996	3290.9	3690.1	7.7024;
            20	640	0.2091	3362.2	3780.4	7.8035;
            20	700	0.2232	3470.9	3917.4	7.9487;
            30	240	0.0682	2619.7	2824.3	6.2265;
            30	280	0.0771	2709.9	2941.3	6.4462;
            30	320	0.085	2788.4	3043.4	6.6245;
            30	360	0.0923	2861.7	3138.7	6.7801;
            30	400	0.0994	2932.8	3230.9	6.9212;
            30	440	0.1062	3002.9	3321.5	7.052;
            30	500	0.1162	3108	3456.5	7.2338;
            30	540	0.1227	3178.4	3546.6	7.3474;
            30	600	0.1324	3285	3682.3	7.5085;
            30	640	0.1388	3357	3773.5	7.6106;
            30	700	0.1484	3466.5	3911.7	7.7571;
            40	280	0.05546	2680	2901.8	6.2568;
            40	320	0.06199	2767.4	3015.4	6.4553;
            40	360	0.06788	2845.7	3117.2	6.6215;
            40	400	0.07341	2919.9	3213.6	6.769;
            40	440	0.07872	2992.2	3307.1	6.9041;
            40	500	0.08643	3099.5	3445.3	7.0901;
            40	540	0.09145	3171.1	3536.9	7.2056;
            40	600	0.09885	3279.1	3674.4	7.3688;
            40	640	0.1037	3351.8	3766.6	7.472;
            40	700	0.111	3462.1	3905.9	7.6198;
            40	740	0.1157	3536.6	3999.6	7.7141;
            60	280	0.03317	2605.2	2804.2	5.9252;
            60	320	0.03876	2720	2952.6	6.1846;
            60	360	0.04331	2811.2	3071.1	6.3782;
            60	400	0.04739	2892.9	3177.2	6.5408;
            60	440	0.05122	2970	3277.3	6.6853;
            60	500	0.05665	3082.2	3422.2	6.8803;
            60	540	0.06015	3156.1	3517	6.9999;
            60	600	0.06525	3266.9	3658.4	7.1677;
            60	640	0.06859	3341	3752.6	7.2731;
            60	700	0.07352	3453.1	3894.1	7.4234;
            60	740	0.07677	3528.3	3989.2	7.519;
            80	320	0.02682	2662.7	2877.2	5.9489;
            80	360	0.03089	2772.7	3019.8	6.1819;
            80	400	0.03432	2863.8	3138.3	6.3634;
            80	440	0.03742	2946.7	3246.1	6.519;
            80	480	0.04034	3025.7	3348.4	6.6586;
            80	520	0.04313	3102.7	3447.7	6.7871;
            80	560	0.04582	3178.7	3545.3	6.9072;
            80	600	0.04845	3254.4	3642	7.0206;
            80	640	0.05102	3330.1	3738.3	7.1283;
            80	700	0.05481	3443.9	3882.4	7.2812;
            80	740	0.05729	3520.4	3978.7	7.3782;
            100	320	0.01925	2588.8	2781.3	5.7103;
            100	360	0.02331	2729.1	2962.1	6.006;
            100	400	0.02641	2832.4	3096.5	6.212;
            100	440	0.02911	2922.1	3213.2	6.3805;
            100	480	0.0316	3005.4	3321.4	6.5282;
            100	520	0.03394	3085.6	3425.1	6.6622;
            100	560	0.03619	3164.1	3526	6.7864;
            100	600	0.03837	3241.7	3625.3	6.9029;
            100	640	0.04048	3318.9	3723.7	7.0131;
            100	700	0.04358	3434.7	3870.5	7.1687;
            100	740	0.0456	3512.1	3968.1	7.267;
            120	360	0.01811	2678.4	2895.7	5.8361;
            120	400	0.02108	2798.3	3051.3	6.0747;
            120	440	0.02355	2896.1	3178.7	6.2586;
            120	480	0.02576	2984.4	3293.5	6.4154;
            120	520	0.02781	3068	3401.8	6.5555;
            120	560	0.02977	3149	3506.2	6.684;
            120	600	0.03164	3228.7	3608.3	6.8037;
            120	640	0.03345	3307.5	3709	6.9164;
            120	700	0.0361	3425.2	3858.4	7.0749;
            120	740	0.03781	3503.7	3957.4	7.1746;
            140	360	0.01422	2617.4	2816.5	5.6602;
            140	400	0.01722	2760.9	3001.9	5.9448;
            140	440	0.01954	2868.6	3142.2	6.1474;
            140	480	0.02157	2962.5	3264.5	6.3143;
            140	520	0.02343	3049.8	3377.8	6.461;
            140	560	0.02517	3133.6	3486	6.5941;
            140	600	0.02683	3215.4	3591.1	6.7172;
            140	640	0.02843	3296	3694.1	6.8326;
            140	700	0.03075	3415.7	3846.2	6.9939;
            140	740	0.03225	3495.2	3946.7	7.0952;
            160	360	0.01105	2539	2715.8	5.4614;
            160	400	0.01426	2719.4	2947.6	5.8175;
            160	440	0.01652	2839.4	3103.7	6.0429;
            160	480	0.01842	2939.7	3234.4	6.2215;
            160	520	0.02013	3031.1	3353.3	6.3752;
            160	560	0.02172	3117.8	3465.4	6.5132;
            160	600	0.02323	3201.8	3573.5	6.6399;
            160	640	0.02467	3284.2	3678.9	6.758;
            160	700	0.02674	3406	3833.9	6.9224;
            160	740	0.02808	3486.7	3935.9	7.0251;
            180	360	0.00809	2418.9	2564.5	5.1922;
            180	400	0.0119	2672.8	2887	5.6887;
            180	440	0.01414	2808.2	3062.8	5.9428;
            180	480	0.01596	2915.9	3203.2	6.1345;
            180	520	0.01757	3011.8	3378	6.296;
            180	560	0.01904	3101.7	3444.4	6.4392;
            180	600	0.02042	3188	3555.6	6.5696;
            180	640	0.02174	3272.3	3663.6	6.6905;
            180	700	0.02362	3396.3	3821.5	6.858;
            180	740	0.02483	3478	3925	6.9623;
            200	400	0.00994	2619.3	2818.1	5.554;
            200	440	0.01222	2774.9	3019.4	5.845;
            200	480	0.01399	2891.2	3170.8	6.0518;
            200	520	0.01551	2992	3302.2	6.2218;
            200	560	0.01689	3085.2	3423	6.3705;
            200	600	0.01818	3174	3537.6	6.5048;
            200	640	0.0194	3260.2	3648.1	6.6286;
            200	700	0.02113	3386.4	3809	6.7993;
            200	740	0.02224	3469.3	3914.1	6.9052;
            200	800	0.02385	3592.7	4069.7	7.0544;
            240	400	0.00673	2477.8	2639.4	5.2393;
            240	440	0.00929	2700.6	2923.4	5.6506;
            240	480	0.011	2838.3	3102.3	5.895;
            240	520	0.01241	2950.5	3248.5	6.0842;
            240	560	0.01366	3051.1	3379	6.2448;
            240	600	0.01481	3145.2	3500.7	6.3875;
            240	640	0.01588	3235.5	3616.7	6.5174;
            240	700	0.01739	3366.4	3783.8	6.6947;
            240	740	0.01835	3451.7	3892.1	6.8038;
            240	800	0.01974	3578	4051.6	6.9567;
            280	400	0.00383	2223.5	2330.7	4.7494;
            280	440	0.00712	2613.2	2812.6	5.4494;
            280	480	0.00885	2780.8	3028.5	5.7446;
            280	520	0.0102	2906.8	3192.3	5.9566;
            280	560	0.01136	3015.7	3333.7	6.1307;
            280	600	0.01241	3115.6	3463	6.2823;
            280	640	0.01338	3210.3	3584.8	6.4187;
            280	700	0.01473	3346.1	3758.4	6.6029;
            280	740	0.01558	3433.9	3870	6.7153;
            280	800	0.0168	3563.1	4033.4	6.872;
            280	900	0.01873	3774.3	4298.8	7.1084;
            320	400	0.00236	1980.4	2055.9	4.3239;
            320	440	0.00544	2509	2683	5.2327;
            320	480	0.00722	2718.1	2949.2	5.5968;
            320	520	0.00853	2860.7	3133.7	5.8357;
            320	560	0.00963	2979	3287.2	6.0246;
            320	600	0.01061	3085.3	3424.6	6.1858;
            320	640	0.0115	3184.5	3552.5	6.329;
            320	700	0.01273	3325.4	3732.8	6.5203;
            320	740	0.0135	3415.9	3847.8	6.6361;
            320	800	0.0146	3548	4015.1	6.7966;
            320	900	0.01633	3762.7	4285.1	7.0372];
                        
%% Re-express table_A4 to human-readable format

% P_raw  = table_A4(:,1);
% T_raw  = table_A4(:,2);
% nu_raw = table_A4(:,3);
% u_raw  = table_A4(:,4);
% h_raw  = table_A4(:,5);
% s_raw  = table_A4(:,6);

x_raw = table_A4(:,Input1_type);
y_raw = table_A4(:,Input2_type);
z_raw = table_A4(:,Output1_type);
name  = ["Pressure (bar)" , "Temperature (degC)", "nu (m^3/kg)", "u(kJ/kg)", "h(kJ/kg)", "s(kJ/kg/K"];
 
%% Building functions for output variables as a function of the input variables

F = scatteredInterpolant(x_raw,y_raw,z_raw);

[xmin,xmax] = bounds(x_raw);
[ymin,ymax] = bounds(y_raw);
[xGrid,yGrid]=meshgrid(linspace(xmin,xmax,40),linspace(ymin,ymax,40));
zGrid = F(xGrid,yGrid);

%% Calculate output variables from input variables
Output1 = F(Input1,Input2)

%% Test Plot to check input domain range.  Set dummy = 0 to suppress.

dummy = 1;
if dummy == 1
    figure;
    hold on
    contour(xGrid,yGrid,zGrid,'ShowText','on','LineWidth',1)
    plot(x_raw,y_raw,'x');
    plot(Input1,Input2,'^','MarkerSize',12,'LineWidth',2);
    hold off
    xlabel(name(Input1_type));ylabel(name(Input2_type));title(['Contours of ' name(Output1_type)]);grid on
    legend('','RAW Data Points','Request Data Point')
end

prompt1 = 'Are you finished with reading Tables? Y/N [Y] ';
str1 = input(prompt1,'s');
if str1 == 'Y'
    sprintf(" Thank you for using my code. Good luck in Thermo")
else if str1 =='N'
        prompt2 = "Do you need this table again? Y/N [Y]: ";
        str2 = input(prompt2,'s');
        if str2 =="Y"
            sprintf("Type into command Prompt: Table_A4_Dynamic(Input1,Input1_type,Input2,Input2_type,Output1_type)")
        else if str2 == "N"
                Table_reading
            end
        end
        
end
    end
